@page "/"
@using Turnero.Client.Models;
@using Radzen;
@using Turnero.Shared.DTO_Back.Peluquero;

@inject PeluqueroService PeluqueroService;

<PageTitle>Index</PageTitle>


<RadzenTemplateForm Data="@ModelTurno">

    <div class="row d-flex justify-content-center align-items-center  widthPerson">

        <div class="col-md-6">
             <RadzenCard>

                 <div>

                     <h4 class="mb-4">Elija fecha y hora del corte.</h4>
                     <RadzenDatePicker TValue="DateTime?"
                         ShowTime="true"
                         Change=@(args => OnChange(args, "DatePicker with 12 hour time format", "MM/dd/yyyy h:mm tt"))
                         HourFormat="12" DateFormat="MM/dd/yyyy h:mm tt" Class="w-50" 
                         Min="DateTime.Now" 
                     />

                 </div>

                 <br/>

                 <div>

                     <div style="display: flex; align-items: center; margin-bottom: 16px">

                         <RadzenButton Click="@ClearSelection" Text="Clear Selection" />
@*
                         @if (selectedEmployees?.Any() == true)
                         {
                             <div style="margin-left: 16px">
                                 Selected Employee: @selectedEmployees[0].FirstName @selectedEmployees[0].LastName
                             </div>
                         }*@
                     </div>

                     <RadzenDataGrid AllowFiltering="false"
                                                FilterCaseSensitivity="FilterCaseSensitivity.CaseInsensitive"
                                                AllowPaging="true" PageSize="3"
                                                AllowSorting="true" Data="@employees" TItem="PeluqueroData" ColumnWidth="50px"
                                                SelectionMode="DataGridSelectionMode.Single" @bind-Value=@selectedEmployees
                                >
                                    <Columns>
                                        <RadzenDataGridColumn TItem="PeluqueroData" Property="Photo" Title="PeluqueroData" Sortable="false" Filterable="false">
                                            <Template Context="data">
                                                @*<RadzenImage Path="@data.Photo" *@
                                                <RadzenImage Path="https://img.blogs.es/anexom/wp-content/uploads/2018/12/42707058715_61bbdc578f_k.jpg"
                                                             style="width: 50px; height: 50px; border-radius: 8px; margin-right: 8px;" />
                                                @data.Nombre @data.Apellido
                                            </Template>
                                        </RadzenDataGridColumn>

                                        <RadzenDataGridColumn TItem="PeluqueroData" Property="Title" Title="Title" />

                                    </Columns>
                                </RadzenDataGrid>

                     <div class="row ">
                        <div class="col-md-6 m-auto">

                             <RadzenCard class="m-1">
                                 <h3 class="h5">Peluquero seleccionado</h3>
                                 <div class="d-flex flex-row">
                                     <RadzenImage Path="https://img.blogs.es/anexom/wp-content/uploads/2018/12/42707058715_61bbdc578f_k.jpg" Class="rounded-circle float-left mr-3" Style="width: 100px; height: 100px;" />
                                     <div>
                                         <div>Employee</div>
                                         <b>Juan Cruz Ledesma</b>
                                         <div class="mt-3">Company</div>
                                         <b>Peluquero</b>
                                     </div>
                                 </div>
                             </RadzenCard>

                        </div>
                     </div>
                 </div>

                <div class="row d-flex my-3">

                    <RadzenButton Text="Realizar consulta"
                        class="justify-content-center"
                        ButtonStyle="ButtonStyle.Primary"
                       Click=@(() => OnChange(DateTime.Now, "DatePicker with 12 hour time format", "MM/dd/yyyy h:mm tt"))
                    />

                </div>

             </RadzenCard>
        </div>



    </div>
                  
</RadzenTemplateForm>


@code {
    #region VARIABLES

    ///  CALENDARIO
    public ModeloPrueba ModelTurno = new ModeloPrueba
    {
        HorarioCorte = DateTime.Now
    };


    #endregion

    protected override async void OnInitialized()
    {

        await GetAllPeluqueros();

        employees = new List<PeluqueroData>
        {
            new PeluqueroData
            {
                ImagenPerfil= "",
                Nombre= "",
                Apellido= "",
                DNI = "",
            }

        };
        selectedEmployees = employees.Take(1).ToList();
    }



    /* Calendario */

    private void OnChange(DateTime? value, string name, string format)
    {
        Console.WriteLine($"{name} value changed to {value?.ToString(format)}");
        Console.Write("AAAAA " + ModelTurno.HorarioCorte);
    }

    /* Calendario */







    public List<PeluqueroData> employees;
    public IList<PeluqueroData> selectedEmployees;



    private void ClearSelection()
    {
        selectedEmployees = null;
    }

    private async Task GetAllPeluqueros() {

        await this.PeluqueroService.GetAll();


    }



}
